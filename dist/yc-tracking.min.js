/*! yc-tracking - v0.9.0 - 2015-02-23 - Soprex */
(function(){function t(t){"use strict";var e=function(){var t=904,e="//event.yoochoose.net/api/"+t,n=30,i="YCStore",c=function(){var t="yc_localStorageTest";try{return r.localStorage.setItem(t,t),r.localStorage.removeItem(t),!0}catch(e){return!1}},a=function(){return c()?JSON.parse(r.localStorage.getItem(i)):null},o=function(t){if(!c())throw"Local storage not supported!";r.localStorage.setItem(i,JSON.stringify(t))},u=function(){var t=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},l=function(t){var e=a(),r=new Date;return r.setMinutes(r.getMinutes()+n),t||(t=e&&e.expires>(new Date).getTime()?e.userId:u()),o({userId:t,expires:r.getTime()}),t},s=function(t){var e,i="YCCookie",c=r.document.cookie,a=new Date,o=c.indexOf(" "+i+"=");return a.setMinutes(a.getMinutes()+n),t||(-1===o&&(o=c.indexOf(i+"=")),-1===o?t=u():(o=c.indexOf("=",o)+1,e=c.indexOf(";",o),-1===e&&(e=c.length),t=decodeURI(c.substring(o,e)))),r.document.cookie=i+"="+encodeURI(t)+"; expires="+a.toUTCString()+"; path=/",t},d=function(t){return c()?l(t):s(t)},m=function(t){var n=new Image(1,1);n.src=e+t};return this.resetUser=function(){return d(u())},this.trackClick=function(t,e,n){var r="/click/"+d()+"/"+t+"/"+e;return n&&(r+="?categorypath="+encodeURIComponent(n)),m(r),this},this.trackRate=function(t,e,n){var r="/rate/"+d()+"/"+t+"/"+e+"?rating="+n;return m(r),this},this.trackBasket=function(t,e,n){var r="/basket/"+d()+"/"+t+"/"+e;return n&&(r+="?categorypath="+encodeURIComponent(n)),m(r),this},this.trackBuy=function(t,e,n,r,i){var c="/buy/"+d()+"/"+t+"/"+e+"?fullprice="+(r+"").replace(",",".")+i+"&quantity="+n;return m(c),this},this.trackLogin=function(t){var e=d();return e!==t&&(m("/login/"+e+"/"+encodeURIComponent(t)),d(t,!0)),this},this.trackRendered=function(t,e){var n="/rendered/"+d()+"/"+t+"/";return Array.isArray(e)||(e=[e]),m(n+e.join(",")),this},this.trackClickRecommended=function(t,e,n){var r="/clickrecommended/"+d()+"/"+t+"/"+e+"?scenario="+encodeURIComponent(n);return m(r),this},this.trackConsume=function(t,e,n){return m("/consume/"+d()+"/"+t+"/"+e+(n?"?percentage="+n:"")),this},this.trackBlacklist=function(t,e){var n="/blacklist/"+d()+"/"+t+"/"+e;return m(n),this},this},n={validateInt:function(t,e){var n=/^-?\d+$/.test(t);if(!n&&e)throw"Param is not valid. Expected integer.";return n},validateFloat:function(t,e){var n=/^-?\d*(\.\d*)?$/.test(t);if(!n&&e)throw"Param is not valid. Expected number.";return n}};t.YcTracking=new e,t.YcValidator=n}function e(t){"use strict";function e(){var t,e,n,r,c,a,o=document.getElementById("buybox"),u=window.yc_articleId?window.yc_articleId:null;if("ctl_detail"===document.body.className&&o){for(e=o.getElementsByTagName("meta"),a=0;e.length>a;a++)"category"===e[a].getAttribute("itemprop")?t=e[a].getAttribute("content").replace(/ > /g,"/"):u||"identifier"!==e[a].getAttribute("itemprop")||(u=e[a].getAttribute("content").split(":")[1]);u&&(i.trackClick(1,u,t),n=document.getElementById("comments"),r=n?n.getElementsByTagName("form"):null,r&&1===r.length&&(r=r[0],c=r.getElementsByTagName("select"),c&&"sVoteStars"===c[0].name&&(r.onsubmit=function(){i.trackRate(1,u,10*c[0].value)})))}}function n(){var t,e=document.getElementsByTagName("a"),n=document.getElementById("basketButton"),r=function(t){var e=t.target.parentNode.querySelector('[name="yc_articleId"]'),n=t.target.href.split("/"),r=n[n.length-1];i.trackBasket(1,e?e.value:r,document.location.pathname)};for(t=0;e.length>t;t+=1)/checkout\/addArticle\/sAdd/i.test(e[t].href)&&(e[t].onclick=r);"ctl_detail"===document.body.className&&n&&(n.onclick=function(t){var e,n=t.target.parentNode.parentNode,r=n.getElementsByTagName("input"),c=window.yc_articleId?window.yc_articleId:null;if(!c&&r)for(e=0;r.length>e;e+=1)if("sAdd"===r[e].name){c=r[e].value;break}c&&i.trackBasket(1,c,document.location.pathname)})}function r(){var t,e=document.getElementById("yc-buy-items");if("ctl_checkout"===document.body.className&&e)for(t=0;e.children.length>t;t++){var n=e.children[t],r=n.children[0].value,c=n.children[1].value,a=n.children[2].value,o=n.children[3].value;i.trackBuy(1,r,c,a,o)}}var i=t.YcTracking;window.onload=function(){window.yc_trackid&&i.trackLogin(window.yc_trackid),window.yc_tracklogout&&i.resetUser(),e(),n(),r()}}var n=Function,r=new n("return this")(),i=function(n){return t(n),e(n),n.YcTracking};"function"==typeof define&&define.amd?define(function(){return i({})}):i(this)})(this);