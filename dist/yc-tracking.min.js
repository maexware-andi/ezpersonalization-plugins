/*! yc-tracking - v0.8.0 - 2015-02-20 - Soprex */
(function(){function t(t){"use strict";var e=function(){var t=904,e="//event.yoochoose.net/api/"+t,n=30,r="YCStore",c=function(){var t="yc_localStorageTest";try{return i.localStorage.setItem(t,t),i.localStorage.removeItem(t),!0}catch(e){return!1}},a=function(){return c()?JSON.parse(i.localStorage.getItem(r)):null},o=function(t){if(!c())throw"Local storage not supported!";i.localStorage.setItem(r,JSON.stringify(t))},u=function(){var t=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},s=function(t){var e=a(),r=new Date;return r.setMinutes(r.getMinutes()+n),t||(t=e&&e.expires>(new Date).getTime()?e.userId:u()),o({userId:t,expires:r.getTime()}),t},l=function(t){var e,r="YCCookie",c=i.document.cookie,a=new Date,o=c.indexOf(" "+r+"=");return a.setMinutes(a.getMinutes()+n),t||(-1===o&&(o=c.indexOf(r+"=")),-1===o?t=u():(o=c.indexOf("=",o)+1,e=c.indexOf(";",o),-1===e&&(e=c.length),t=decodeURI(c.substring(o,e)))),i.document.cookie=r+"="+encodeURI(t)+"; expires="+a.toUTCString()+"; path=/",t},d=function(t){return c()?s(t):l(t)},m=function(t){var n=new Image(1,1);n.src=e+t};return this.resetUser=function(){return d(u())},this.trackClick=function(t,e,n){var r="/click/"+d()+"/"+t+"/"+e;return n&&(r+="?categorypath="+encodeURIComponent(n)),m(r),this},this.trackRate=function(t,e,n){var r="/rate/"+d()+"/"+t+"/"+e+"?rating="+n;return m(r),this},this.trackBasket=function(t,e,n){var r="/basket/"+d()+"/"+t+"/"+e;return n&&(r+="?categorypath="+encodeURIComponent(n)),m(r),this},this.trackBuy=function(t,e,n,r,i){var c="/buy/"+d()+"/"+t+"/"+e+"?fullprice="+r.replace(",",".")+i+"&quantity="+n;return m(c),this},this.trackLogin=function(t){var e=d();return e!==t&&(m("/login/"+e+"/"+encodeURIComponent(t)),d(t,!0)),this},this.trackRendered=function(t,e){var n="/rendered/"+d()+"/"+t+"/";return Array.isArray(e)||(e=[e]),m(n+e.join(",")),this},this.trackClickRecommended=function(t,e,n){var r="/clickrecommended/"+d()+"/"+t+"/"+e+"?scenario="+encodeURIComponent(n);return m(r),this},this.trackConsume=function(t,e,n){return m("/consume/"+d()+"/"+t+"/"+e+(n?"?percentage="+n:"")),this},this.trackBlacklist=function(t,e){var n="/blacklist/"+d()+"/"+t+"/"+e;return m(n),this},this},n={validateInt:function(t,e){var n=/^-?\d+$/.test(t);if(!n&&e)throw"Param is not valid. Expected integer.";return n},validateFloat:function(t,e){var n=/^-?\d*(\.\d*)?$/.test(t);if(!n&&e)throw"Param is not valid. Expected number.";return n}};t.YcTracking=new e,t.YcValidator=n}function e(){"use strict"}function n(t){"use strict";function e(t){return c?t:"SW"===t.substr(0,2)?t.substr(2):t}function n(){var t,n,r,i,c,o,u,s=document.getElementById("buybox");if("ctl_detail"===document.body.className&&s){for(r=s.getElementsByTagName("meta"),u=0;r.length>u;u++)"category"===r[u].getAttribute("itemprop")?n=r[u].getAttribute("content").replace(/ > /g,"/"):"identifier"===r[u].getAttribute("itemprop")&&(t=r[u].getAttribute("content").split(":")[1]);t&&a.trackClick(1,e(t),n),i=document.getElementById("comments"),c=i?i.getElementsByTagName("form"):null,c&&1===c.length&&(c=c[0],o=c.getElementsByTagName("select"),o&&"sVoteStars"===o[0].name&&(c.onsubmit=function(){a.trackRate(1,e(t),10*o[0].value)}))}}function r(){var t,n=document.getElementsByTagName("a"),r=document.getElementById("basketButton");for(t=0;n.length>t;t+=1)/checkout\/addArticle\/sAdd/i.test(n[t].href)&&(n[t].onclick=function(t){var n=t.target.href.split("/"),r=n[n.length-1];a.trackBasket(1,e(r),document.location.pathname)});"ctl_detail"===document.body.className&&r&&(r.onclick=function(t){var n,r,i=t.target.parentNode.parentNode,c=i.getElementsByTagName("input");if(c)for(r=0;c.length>r;r+=1)if("sAdd"===c[r].name){n=c[r].value;break}n&&a.trackBasket(1,e(n),document.location.pathname)})}function i(){var t,n=document.getElementById("yc-buy-items");if("ctl_checkout"===document.body.className&&n)for(t=0;n.children.length>t;t++){var r=n.children[t],i=r.children[0].value,c=r.children[1].value,o=r.children[2].value,u=r.children[3].value;a.trackBuy(1,e(i),c,o,u)}}var c=!0,a=t.YcTracking;window.onload=function(){window.yc_trackid&&a.trackLogin(yc_trackid),window.yc_tracklogout&&a.resetUser(),n(),r(),i()}}var r=Function,i=new r("return this")(),c=function(r){return t(r),e(r),n(r),r.YcTracking};"function"==typeof define&&define.amd?define(function(){return c({})}):c(this)})(this);