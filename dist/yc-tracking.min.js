/*! yc-tracking - v0.9.0 - 2015-03-02 - Soprex */
(function(){function t(t){"use strict";var e=function(){var t=904,e="//event.yoochoose.net/api/"+t,n=30,o="YCStore",i=function(){var t="yc_localStorageTest";try{return r.localStorage.setItem(t,t),r.localStorage.removeItem(t),!0}catch(e){return!1}},a=function(){return i()?JSON.parse(r.localStorage.getItem(o)):null},c=function(t){if(!i())throw"Local storage not supported!";r.localStorage.setItem(o,JSON.stringify(t))},u=function(){var t=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},d=function(t){var e=a(),r=new Date;return r.setMinutes(r.getMinutes()+n),t||(t=e&&e.expires>(new Date).getTime()?e.userId:u()),c({userId:t,expires:r.getTime()}),t},s=function(t){var e,o="YCCookie",i=r.document.cookie,a=new Date,c=i.indexOf(" "+o+"=");return a.setMinutes(a.getMinutes()+n),t||(-1===c&&(c=i.indexOf(o+"=")),-1===c?t=u():(c=i.indexOf("=",c)+1,e=i.indexOf(";",c),-1===e&&(e=i.length),t=decodeURI(i.substring(c,e)))),r.document.cookie=o+"="+encodeURI(t)+"; expires="+a.toUTCString()+"; path=/",t},l=function(t){return i()?d(t):s(t)},f=function(t){var n=new Image(1,1);n.src=e+t};return this.resetUser=function(){return l(u())},this.trackClick=function(t,e,n){var r="/click/"+l()+"/"+t+"/"+e;return n&&(r+="?categorypath="+encodeURIComponent(n)),f(r),this},this.trackRate=function(t,e,n){var r="/rate/"+l()+"/"+t+"/"+e+"?rating="+n;return f(r),this},this.trackBasket=function(t,e,n){var r="/basket/"+l()+"/"+t+"/"+e;return n&&(r+="?categorypath="+encodeURIComponent(n)),f(r),this},this.trackBuy=function(t,e,n,r,o){var i="/buy/"+l()+"/"+t+"/"+e+"?fullprice="+(r+"").replace(",",".")+o+"&quantity="+n;return f(i),this},this.trackLogin=function(t){var e=l();return t&&e!==t&&(f("/login/"+e+"/"+encodeURIComponent(t)),l(t,!0)),this},this.trackRendered=function(t,e){var n="/rendered/"+l()+"/"+t+"/";return Array.isArray(e)||(e=[e]),f(n+e.join(",")),this},this.trackClickRecommended=function(t,e,n){var r="/clickrecommended/"+l()+"/"+t+"/"+e+"?scenario="+encodeURIComponent(n);return f(r),this},this.trackConsume=function(t,e,n){return f("/consume/"+l()+"/"+t+"/"+e+(n?"?percentage="+n:"")),this},this.trackBlacklist=function(t,e){var n="/blacklist/"+l()+"/"+t+"/"+e;return f(n),this},this},n={validateInt:function(t,e){var n=/^-?\d+$/.test(t);if(!n&&e)throw"Param is not valid. Expected integer.";return n},validateFloat:function(t,e){var n=/^-?\d*(\.\d*)?$/.test(t);if(!n&&e)throw"Param is not valid. Expected number.";return n}};t.YcTracking=new e,t.YcValidator=n}function e(t){"use strict";function e(){var t,e,n,r,o=document.getElementById("product_addtocart_form"),a=window.yc_articleId?window.yc_articleId:null,c="";if(document.getElementById("review-form"),o&&(a||o.product&&(a=o.product.value),t=document.getElementsByClassName("breadcrumbs")))for(e=t[0].children[0].children,r=0;e.length>r;r++)-1!==e[r].className.indexOf("category")&&(c+=e[r].children[0].text+"/");a&&(i.trackClick(1,a,c),n&&(n.onsubmit=function(){var t=function(t,e){for(var n=0;t.length>n;n++)if(t[n].checked)return parseInt(t[n].value)-e;return 0},e=t(this.elements["ratings[1]"],0),n=t(this.elements["ratings[2]"],5),r=t(this.elements["ratings[3]"],10);0!==e&&0!==n&&0!==r&&(i.trackRate(1,a,20*e),i.trackRate(1,a,20*n),i.trackRate(1,a,20*r))}))}function n(){function t(t){if(window[t]){var n=window[t];window[t]=function(t){e(t),n(t)}}}function e(t){if(/checkout\/cart\/add/i.test(t)){var e,n,r=t.split("/");for(n=0;r.length>n;n++)if("product"===r[n]){e=parseInt(r[n+1]);break}e&&i.trackBasket(1,e,document.location.pathname)}}function n(t){var e=null,n=function(){this.product&&this.product.value&&i.trackBasket(1,this.product.value,document.location.pathname),e&&e.call(this)};t&&(e=t.submit,t.submit=n)}var r=document.getElementById("product_addtocart_form");if(t("setLocation"),t("setPLocation"),window.addWItemToCart){var o=window.addWItemToCart;window.addWItemToCart=function(t){i.trackBasket(1,t,document.location.pathname),o(t)}}if(window.addAllWItemsToCart){var a=window.addAllWItemsToCart;window.addAllWItemsToCart=function(){var t,e,n;if(a(),e=document.getElementById("qty"),e&&(t=JSON.parse(e.value)))for(n=0;t.length>n;n++)t[n]&&i.trackBasket(1,n,document.location.pathname)}}r&&n(r),window.productAddToCartForm&&n(window.productAddToCartForm.form)}function r(){var t,e,n;if(window.yc_orderData)for(t=window.yc_orderData,n=0;t.length>n;n++)e=t[n],e&&i.trackBuy(1,parseInt(e.id),parseInt(e.quantity),parseFloat(e.price),e.currency)}function o(){var t,e=document.getElementById("header-account"),n=e?e.getElementsByTagName("a"):null;if(n)for(t=0;n.length>t;t++)/customer\/account\/logout/i.test(n[t].href)&&(n[t].onclick=function(){i.resetUser()})}var i=t.YcTracking;window.onload=function(){i.trackLogin(window.yc_trackid),e(),n(),o(),r()}}var n=Function,r=new n("return this")(),o=function(n){return t(n),e(n),n.YcTracking};"function"==typeof define&&define.amd?define(function(){return o({})}):o(this)})(this);