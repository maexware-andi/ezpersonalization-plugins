/*! yc-tracking - v0.0.1 - 2015-02-19 - Soprex */
(function(){function t(t){"use strict";var e=function(){var t=903,e="//event.yoochoose.net/api/"+t,n=30,r="YCStore",o=function(){var t="yc_localStorageTest";try{return i.localStorage.setItem(t,t),i.localStorage.removeItem(t),!0}catch(e){return!1}},c=function(){return o()?JSON.parse(i.localStorage.getItem(r)):null},a=function(t){if(!o())throw"Local storage not supported!";i.localStorage.setItem(r,JSON.stringify(t))},u=function(){var t=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},s=function(t){var e=c(),r=new Date;return r.setMinutes(r.getMinutes()+n),t||(t=e&&e.expires>(new Date).getTime()?e.userId:u()),a({userId:t,expires:r.getTime()}),t},d=function(t){var e,r="YCCookie",o=i.document.cookie,c=new Date,a=o.indexOf(" "+r+"=");return c.setMinutes(c.getMinutes()+n),t||(-1===a&&(a=o.indexOf(r+"=")),-1===a?t=u():(a=o.indexOf("=",a)+1,e=o.indexOf(";",a),-1===e&&(e=o.length),t=decodeURI(o.substring(a,e)))),i.document.cookie=r+"="+encodeURI(t)+"; expires="+c.toUTCString()+"; path=/",t},f=function(t,e){return o()?s(t,e):d(t,e)},l=function(t){var n=new Image(1,1);n.src=e+t};return this.resetUser=function(){return f(u())},this.trackClick=function(t,e,n){var r="/click/"+f()+"/"+t+"/"+e;return n&&(r+="?categorypath="+encodeURIComponent(n)),l(r),this},this.trackRate=function(t,e,n){var r="/rate/"+f()+"/"+t+"/"+e+"?rating="+n;return l(r),this},this.trackBasket=function(t,e,n){var r="/basket/"+f()+"/"+t+"/"+e;return n&&(r+="?categorypath="+encodeURIComponent(n)),l(r),this},this.trackBuy=function(t,e,n,r,i){var o="/buy/"+f()+"/"+t+"/"+e+"?fullprice="+r+i+"&quantity="+n;return l(o),this},this.trackLogin=function(t){var e=f();return e!==t&&(l("/login/"+e+"/"+encodeURIComponent(t)),f(t,!0)),this},this.trackRendered=function(t,e){var n="/rendered/"+f()+"/"+t+"/";return Array.isArray(e)||(e=[e]),l(n+e.join(",")),this},this.trackClickRecommended=function(t,e,n){var r="/clickrecommended/"+f()+"/"+t+"/"+e+"?scenario="+encodeURIComponent(n);return l(r),this},this.trackConsume=function(t,e,n){return l("/consume/"+f()+"/"+t+"/"+e+(n?"?percentage="+n:"")),this},this.trackBlacklist=function(t,e){var n="/blacklist/"+f()+"/"+t+"/"+e;return l(n),this},this},n={validateInt:function(t,e){var n=/^-?\d+$/.test(t);if(!n&&e)throw"Param is not valid. Expected integer.";return n},validateFloat:function(t,e){var n=/^-?\d*(\.\d*)?$/.test(t);if(!n&&e)throw"Param is not valid. Expected number.";return n}};t.YcTracking=new e,t.YcValidator=n}function e(){"use strict"}function n(t){"use strict";function e(t){return"SW"===t.substr(0,2)?t.substr(2):t}function n(){var t,n,r,o,c=document.getElementById("buybox");if("ctl_detail"===document.body.className&&c){for(r=c.getElementsByTagName("meta"),o=0;r.length>o;o++)"category"===r[o].getAttribute("itemprop")?n=r[o].getAttribute("content").replace(/ > /g,"/"):"identifier"===r[o].getAttribute("itemprop")&&(t=r[o].getAttribute("content").split(":")[1]);t&&i.trackClick(1,e(t),n)}}function r(){var t,n=document.getElementsByTagName("a"),r=document.getElementById("basketButton");for(t=0;n.length>t;t+=1)/checkout\/addArticle\/sAdd/i.test(n[t].href)&&(n[t].onclick=function(t){var n=t.target.href.split("/"),r=n[n.length-1];i.trackBasket(1,e(r),document.location.href)});"ctl_detail"===document.body.className&&r&&(r.onclick=function(t){var n,r,o=t.target.parentNode.parentNode,c=o.getElementsByTagName("input");if(c)for(r=0;c.length>r;r+=1)if("sAdd"===c[r].name){n=c[r].value;break}n&&i.trackBasket(1,e(n),document.location.href)})}var i=t.YcTracking;window.onload=function(){window.yc_trackid&&i.trackLogin(yc_trackid),window.yc_tracklogout&&i.resetUser(),n(),r()}}var r=Function,i=new r("return this")(),o=function(r){return t(r),e(r),n(r),r.YcTracking};"function"==typeof define&&define.amd?define(function(){return o({})}):o(this)})(this);